@page "/foreign-languages"
@inherits _UserLayout

<CascadingValue Value="10" Name="PageSize">
    <SimpleEditUserITResumeDbModels Service="ForeignLanguageService" TModel="ForeignLanguage" GetModels="@(us => us.GetUserForeignLanguagesAsync())">
        <Columns>
            <GridColumn Field=@nameof(ForeignLanguage.HumanLanguageId) HeaderText="Name">
                <Template>
                    @(((ForeignLanguage)context)!.HumanLanguage?.Name ?? "no name")
                </Template>
                <EditTemplate>
                    <SfDropDownList TItem="HumanLanguage" TValue="long" DataSource="@humanLanguages"
                                    @bind-Value="@((context as ForeignLanguage)!.HumanLanguageId)">
                        <DropDownListFieldSettings Text="Name" Value="Id" />
                    </SfDropDownList>
                </EditTemplate>
            </GridColumn>
            <GridColumn Field=@nameof(ForeignLanguage.LanguageLevel)>
                <EditTemplate>
                    <SfDropDownList ID="LanguageLevel" TItem="string" TValue="LanguageLevel"
                                    @bind-Value="@((context as ForeignLanguage)!.LanguageLevel)"
                                    DataSource="@languageLevelEnumValues" />
                </EditTemplate>
            </GridColumn>
        </Columns>
    </SimpleEditUserITResumeDbModels>
</CascadingValue>

@code {
    string[] languageLevelEnumValues = Enum.GetNames<LanguageLevel>();

    [Inject]
    public IForeignLanguageService ForeignLanguageService { get; set; } = null!;

    [Inject]
    public IHumanLanguageService HumanLanguageService { get; set; } = null!;

    IEnumerable<HumanLanguage>? humanLanguages;
    protected override async Task OnInitializedAsync()
        => humanLanguages = await HumanLanguageService.GetAllModelsAsync();
}
